{"version":3,"sources":["login_v2_m.coffee"],"names":[],"mappings":"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","file":"login_v2_m.js","sourceRoot":"/source/","sourcesContent":["$(->\n  v_login = new Vue\n    el:'#v_login'\n    data:\n      error_info:false\n      loading:false\n    methods:\n      check:->\n        if @user_name in ['', undefined]\n          throw new Error(\"请输入用户名\")\n        if @password in ['', undefined]\n          throw new Error(\"请输入用密码\")\n      #通用的post,传入type\n      post:(type)->\n        if type == 'login'\n          parm = JSON.stringify\n            user_name:@user_name\n            password:@password\n            type:type\n            #尝试取验证的数据\n            geetest_challenge : $('.geetest_challenge').val()\n            geetest_validate : $('.geetest_validate').val()\n            geetest_seccode : $('.geetest_seccode').val()\n            validate: $('#validate').val()\n        else if type == 'signup'\n          console.log window.regexp\n          for key of window.regexp\n            value = window.regexp[key]\n            console.log value\n            if value == false\n              throw new Error(\"您的邮箱无法验证，请填写正确的邮箱。\")\n          parm = JSON.stringify\n            user_name:@user_name\n            user_type:@user_type\n            password:@password\n            email:@email\n            type:type\n        else if type == 'forget'\n          parm = JSON.stringify\n            email:@email\n            type:type\n        @loading=true\n        $.post '/login', parm ,(result, done)=>\n          @loading=false\n          if result.error != '0'\n            #后台说这个用户没有时,提示用户创建\n            if result.error == 'user not exist' and type =='login'\n              $('#confirm-ask-create').modal()\n              return\n            @error_info = result.error\n          else if result.error == undefined\n            @error_info = '未知错误'\n          else\n            location.pathname = '/'\n      createUserByModal:->\n        $('#go_signup').tab('show')\n      login:->\n        @error_info = false\n        @check()\n        @post('login')\n      signup:->\n        @check()\n        if @password != @repassword\n          @error_info = '两次密码不一致'\n          return\n        if @email in ['', undefined]\n          @error_info = '请输入邮箱'\n          return\n        if @user_type is ''\n          throw new Error(\"请选择用户类型\")\n        @post('signup')\n      forget:->\n        if @email in ['', undefined]\n          @error_info = '请输入邮箱'\n          return\n        parm = JSON.stringify\n          email:@email\n          type:'forget'\n        @loading=true\n        $.post '/login', parm, (result, done)=>\n          @loading=false\n          if result.error != '0'\n            @error_info = result.error\n          else if result.error == undefined\n            @error_info = '未知错误'\n          else\n            window.bz.showSuccess5('邮件已经发送,请查看你的邮箱来修改密码!')\n\n      setPassword:->\n        if @password_set != @repassword_set\n          throw new Error(\"两次输入的密码不一致\")\n        @loading = true\n        parm = JSON.stringify\n          token:hash[1]\n          password:@password_set\n          type:'setPassword'\n        $.post '/login', parm, (result, done)=>\n          @loading = false\n          if result.error != '0'\n            throw new Error(result.error)\n          else\n            window.bz.showSuccess5('设置成功，请重新登录')\n\n      cleanError:->\n        @$data.error_info = false\n\n  window.bz.setOnErrorVm(v_login)\n\n  hash = window.bz.getHashParms()\n  if hash[0] == \"#token\"\n    $ '#tab a'\n      .tab('show')\n  url = window.bz.getUrlParm()\n  if url[1] == \"profile\"\n    $ '#tab a'\n      .tab('show')\n)\n"]}